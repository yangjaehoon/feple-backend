<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${festival.title}">페스티벌 상세</title>
    <style>
        .festival-header { display:flex; gap:16px; align-items:flex-start; }
        .poster { width:220px; height:auto; border:1px solid #ddd; }
        .meta p { margin:6px 0; }
    </style>
</head>
<body>

<h1 th:text="${festival.title}">페스티벌</h1>

<div class="festival-header">
    <!-- 포스터 -->
    <div>
        <img class="poster"
             th:if="${festival.posterUrl != null and !#strings.isEmpty(festival.posterUrl)}"
             th:src="${festival.posterUrl}"
             th:alt="${festival.title} + ' 포스터'"/>
        <div th:if="${festival.posterUrl == null or #strings.isEmpty(festival.posterUrl)}">
            포스터 이미지가 없습니다.
        </div>
    </div>
<!-- 페스티벌 기본 정보 -->
<div class="meta">
    <p><strong>기간:</strong>
        <span th:text="${festival.startDate} + ' ~ ' + ${festival.endDate}"></span>
    </p>
    <p><strong>장소:</strong> <span th:text="${festival.location}">장소</span></p>
    <p><strong>설명:</strong> <span th:text="${festival.description}">설명</span></p>
</div>
</div>

<!-- 참여 아티스트 리스트 -->
<h3>참여 아티스트 (<span th:text="${participatingArtists.size() ?: 0}">0</span>명)</h3>
<table border="1">
    <thead>
    <tr>
        <th>순서</th>
        <th>아티스트</th>
        <th>장르</th>
        <th>스테이지</th>
        <th>삭제</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="af : ${participatingArtists}">
        <td th:text="${af.lineupOrder}">1</td>
        <td th:text="${af.artist.name}">이름</td>
        <td th:text="${af.artist.genre}">장르</td>
        <td th:text="${af.stageName}">스테이지</td>
        <!-- 삭제 버튼 -->
        <td>
            <form th:action="@{/admin/festivals/{fid}/artists/{aid}/delete(fid=${festival.id}, aid=${af.id})}"
                  method="post" style="display:inline;">
                <button type="submit" onclick="return confirm('삭제하시겠습니까?')">삭제</button>
            </form>
        </td>
    </tr>
    <tr th:if="${participatingArtists.isEmpty() ?: true}">
        <td colspan="5">참여 아티스트가 없습니다.</td>
    </tr>
    </tbody>
</table>

<a th:href="@{/admin/festivals/{id}/artists/new(id=${festival.id})}" class="btn btn-primary">아티스트 추가</a>
<a th:href="@{/admin/festivals}" class="btn btn-secondary">목록</a>
</body>